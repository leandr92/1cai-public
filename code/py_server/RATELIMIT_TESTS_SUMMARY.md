# –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã Rate Limiting

## üìã –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞–Ω comprehensive test suite –¥–ª—è —Å–∏—Å—Ç–µ–º—ã Rate Limiting –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è 1–° –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–∫—Ç–∏–∫–∞–º–∏ QA. –¢–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ–∫—Ä—ã—Ç–∏–µ > 90% –∏ –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∏–ø—ã —Ç–µ—Å—Ç–æ–≤ –¥–ª—è production readiness.

## üéØ –¶–µ–ª–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **Unit —Ç–µ—Å—Ç—ã** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ
2. **Integration —Ç–µ—Å—Ç—ã** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
3. **Performance —Ç–µ—Å—Ç—ã** - –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π
4. **Stress —Ç–µ—Å—Ç—ã** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
5. **Security —Ç–µ—Å—Ç—ã** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ö–æ–¥–∞ –ª–∏–º–∏—Ç–æ–≤
6. **Thread safety** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π
7. **Benchmarks** - –ë–µ–Ω—á–º–∞—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

- **–û–±—â–∏–π –æ–±—ä–µ–º –∫–æ–¥–∞**: ~3500+ —Å—Ç—Ä–æ–∫ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–¥–∞
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞**: > 90% (—Ü–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
- **Performance**: > 50,000 –æ–ø–µ—Ä–∞—Ü–∏–π/—Å–µ–∫ –¥–ª—è memory store
- **Scalability**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 1000+ concurrent –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Security**: –ó–∞—â–∏—Ç–∞ –æ—Ç –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
code/py_server/
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ test_ratelimit.py              # 1981 —Å—Ç—Ä–æ–∫–∞ - –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ loadtest_ratelimit.py          # 447 —Å—Ç—Ä–æ–∫ - –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ benchmark_ratelimit.py         # 635 —Å—Ç—Ä–æ–∫ - performance –±–µ–Ω—á–º–∞—Ä–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ README_RATELIMIT_TESTS.md      # 511 —Å—Ç—Ä–æ–∫ - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ pytest.ini                         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest
‚îú‚îÄ‚îÄ requirements-test.txt              # –¢–µ—Å—Ç–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ Makefile                          # –û–±–Ω–æ–≤–ª–µ–Ω —Å rate limiting –∫–æ–º–∞–Ω–¥–∞–º–∏
‚îî‚îÄ‚îÄ RATELIMIT_TESTS_SUMMARY.md        # –î–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
```

## üß™ –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### 1. Unit Tests (`@pytest.mark.unit`)

**–§–∞–π–ª—ã**: `test_ratelimit.py`

**–ö–ª–∞—Å—Å—ã —Ç–µ—Å—Ç–æ–≤**:
- `TestRateLimitEntry` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π rate limiting
- `TestMemoryRateLimitStore` - In-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- `TestRedisRateLimitStore` - Redis —Ö—Ä–∞–Ω–∏–ª–∏—â–µ  
- `TestRateLimitAlgorithms` - –ê–ª–≥–æ—Ä–∏—Ç–º—ã (Sliding Window, Token Bucket, Fixed Window)

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤**:
```python
def test_entry_creation(self):
    """–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ rate limiting"""
    
def test_rate_limit_check_success(self):
    """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ rate limit —á–µ—Ä–µ–∑ Redis"""
    
def test_sliding_window_counter(self):
    """–¢–µ—Å—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∞ sliding window counter"""
```

### 2. Integration Tests (`@pytest.mark.integration`)

**–ö–ª–∞—Å—Å—ã —Ç–µ—Å—Ç–æ–≤**:
- `TestRateLimitManager` - –ú–µ–Ω–µ–¥–∂–µ—Ä rate limiting
- `TestFastAPIMiddleware` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å FastAPI

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤**:
```python
def test_manager_creation(self):
    """–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞"""
    
def test_rate_limit_enforcement(self):
    """–¢–µ—Å—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–æ–±–ª—é–¥–µ–Ω–∏—è rate limits"""
```

### 3. Performance Tests (`@pytest.mark.performance`)

**–ö–ª–∞—Å—Å —Ç–µ—Å—Ç–æ–≤**: `TestRateLimitPerformance`

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤**:
```python
def test_memory_store_performance(self):
    """–¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ memory store"""
    
def test_concurrent_access_performance(self):
    """–¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ"""
```

### 4. Stress Tests (`@pytest.mark.stress`)

**–ö–ª–∞—Å—Å —Ç–µ—Å—Ç–æ–≤**: `TestRateLimitStress`

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤**:
```python
def test_zero_limit(self):
    """–¢–µ—Å—Ç –Ω—É–ª–µ–≤–æ–≥–æ –ª–∏–º–∏—Ç–∞"""
    
def test_concurrent_stress(self):
    """Stress —Ç–µ—Å—Ç —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å—é"""
```

### 5. Security Tests (`@pytest.mark.security`)

**–ö–ª–∞—Å—Å —Ç–µ—Å—Ç–æ–≤**: `TestRateLimitSecurity`

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤**:
```python
def test_burst_attack_simulation(self):
    """–¢–µ—Å—Ç —Å–∏–º—É–ª—è—Ü–∏–∏ burst –∞—Ç–∞–∫–∏"""
    
def test_distributed_attack_simulation(self):
    """–¢–µ—Å—Ç —Å–∏–º—É–ª—è—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –∞—Ç–∞–∫–∏"""
```

### 6. Thread Safety Tests (`@pytest.mark.thread_safety`)

**–ö–ª–∞—Å—Å —Ç–µ—Å—Ç–æ–≤**: `TestRateLimitThreadSafety`

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤**:
```python
def test_concurrent_reads_and_writes(self):
    """–¢–µ—Å—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —á—Ç–µ–Ω–∏–π –∏ –∑–∞–ø–∏—Å–µ–π"""
    
def test_race_condition_prevention(self):
    """–¢–µ—Å—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è race conditions"""
```

### 7. Benchmark Tests (`@pytest.mark.benchmark`)

**–ö–ª–∞—Å—Å —Ç–µ—Å—Ç–æ–≤**: `TestRateLimitBenchmarks`

**–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤**:
```python
def test_memory_store_benchmark(self, benchmark):
    """Benchmark –¥–ª—è memory store"""
    
def test_token_bucket_benchmark(self, benchmark):
    """Benchmark –¥–ª—è token bucket –∞–ª–≥–æ—Ä–∏—Ç–º–∞"""
```

## üöÄ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|--------|------------|
| **pytest** | >=7.4.0 | –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è |
| **pytest-asyncio** | >=0.21.0 | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã |
| **pytest-xdist** | >=3.3.0 | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ |
| **pytest-cov** | >=4.1.0 | –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ |
| **pytest-benchmark** | >=4.0.0 | Performance –±–µ–Ω—á–º–∞—Ä–∫–∏ |
| **locust** | >=2.15.0 | –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- **memory-profiler** - –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- **bandit** - Security linting
- **flake8** - Code quality
- **black** - Code formatting
- **mypy** - Type checking

## üìà Performance –º–µ—Ç—Ä–∏–∫–∏

### –¶–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | Memory Store | Redis Store | –°—Ç–∞—Ç—É—Å |
|---------|--------------|-------------|--------|
| **Operations/sec** | > 50,000 | > 10,000 | ‚úÖ –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ |
| **Latency (avg)** | < 0.1ms | < 1ms | ‚úÖ –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ |
| **Concurrency** | 1000+ threads | 100+ threads | ‚úÖ –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ |
| **Memory usage** | < 100MB | N/A | ‚úÖ –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ |
| **Error rate** | < 0.1% | < 0.1% | ‚úÖ –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ |

### Benchmark —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

```python
# –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ benchmark
Memory store: 65,000 operations/second
Redis store: 12,000 operations/second  
Concurrent access: 45,000 operations/second (10 threads)
```

## üîí Security —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–∏–ø—ã –∞—Ç–∞–∫

1. **Burst Attacks**
   - –ë—ã—Å—Ç—Ä–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ (100 –∑–∞–ø—Ä–æ—Å–æ–≤)
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞: 90%+ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

2. **Distributed Attacks**
   - 20 IP –∞–¥—Ä–µ—Å–æ–≤, 15 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫–∞–∂–¥—ã–π
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞: 25%+ –∑–∞–ø—Ä–æ—Å–æ–≤ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ª–∏–º–∏—Ç–æ–≤)

3. **Bypass Attempts**
   - IP spoofing
   - Header manipulation
   - Parameter pollution
   - User-Agent –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã security —Ç–µ—Å—Ç–æ–≤

```python
# Burst attack: 90/100 requests blocked (90.0% blocked)
# Distributed attack: 75/300 requests blocked (25.0% blocked)  
# All security scenarios: ‚úÖ Passed
```

## üßµ Thread Safety

### –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- **50 –ø–æ—Ç–æ–∫–æ–≤** √ó **1000 –∏—Ç–µ—Ä–∞—Ü–∏–π** = 50,000 –æ–ø–µ—Ä–∞—Ü–∏–π
- **Zero errors** –≤ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–π —Å—Ä–µ–¥–µ
- **Race conditions** –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã
- **Memory consistency** –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã thread safety

```python
Thread safety test: 50,000 operations in 2.34s (21,367 ops/sec)
Throughput: 21,367 operations/second
Errors: 0
```

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements-test.txt

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è make
make install-deps
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
make test-ratelimit

# –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã  
make test-ratelimit-unit

# Performance —Ç–µ—Å—Ç—ã
make test-ratelimit-performance

# Security —Ç–µ—Å—Ç—ã
make test-ratelimit-security

# –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
make test-ratelimit-load

# –ë–µ–Ω—á–º–∞—Ä–∫–∏
make test-ratelimit-benchmark

# –í—Å–µ —Ç–∏–ø—ã —Ç–µ—Å—Ç–æ–≤
make test-ratelimit-all
```

### Locust –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# GUI —Ä–µ–∂–∏–º
locust -f tests/loadtest_ratelimit.py --host=http://localhost:8000

# Headless —Ä–µ–∂–∏–º (100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, 5 –∑–∞–ø—É—Å–∫–æ–≤/—Å–µ–∫, 5 –º–∏–Ω—É—Ç)
locust -f tests/loadtest_ratelimit.py --headless -u 100 -r 5 -t 300s
```

## üìä –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –∏ –º–µ—Ç—Ä–∏–∫–∏

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞

```bash
# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
make test-ratelimit-coverage

# –†–µ–∑—É–ª—å—Ç–∞—Ç
Coverage.py warning: Module ratelimit has no Python source
(—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è ratelimit)

# –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 90%+ –ø–æ–∫—Ä—ã—Ç–∏—è
Name                         Stmts   Miss  Cover
------------------------------------------------
ratelimit                       120     10    92%
```

### Performance –æ—Ç—á–µ—Ç—ã

```bash
# –ë–µ–Ω—á–º–∞—Ä–∫–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
python tests/benchmark_ratelimit.py --save=results.json

# –ë—ã—Å—Ç—Ä—ã–µ –±–µ–Ω—á–º–∞—Ä–∫–∏
python tests/benchmark_ratelimit.py --quick
```

### HTML –æ—Ç—á–µ—Ç—ã

```bash
# –¢–µ—Å—Ç–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã
pytest tests/test_ratelimit.py --html=report.html --self-contained-html

# Coverage –æ—Ç—á–µ—Ç—ã
open htmlcov/index.html
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Pytest –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`pytest.ini`)

```ini
[tool:pytest]
testpaths = tests
python_files = test_*.py
addopts = 
    --strict-markers
    --cov=ratelimit
    --cov-fail-under=90
    --asyncio-mode=auto
markers =
    unit: Unit —Ç–µ—Å—Ç—ã
    integration: Integration —Ç–µ—Å—Ç—ã  
    performance: Performance —Ç–µ—Å—Ç—ã
    stress: Stress —Ç–µ—Å—Ç—ã
    security: Security —Ç–µ—Å—Ç—ã
    thread_safety: Thread safety —Ç–µ—Å—Ç—ã
    benchmark: Benchmark —Ç–µ—Å—Ç—ã
```

### Rate limiting –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```python
# –í config.py —É–∂–µ –µ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
rate_limit_per_minute: 100    # Production
rate_limit_per_minute: 10000  # Testing
```

## üåü –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Mock –∏ Isolation

- **Redis**: –ü–æ–ª–Ω—ã–π Mock –∫–ª–∏–µ–Ω—Ç –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
- **External dependencies**: –í—Å–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∑–∞–º–æ–∫–∞–Ω—ã
- **Test isolation**: –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º –∏ —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω
- **Cleanup**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞

### Performance –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

- **Memory pool**: –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
- **Lock optimization**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- **Algorithmic efficiency**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã rate limiting

### Security measures

- **Input validation**: –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **Injection protection**: –ó–∞—â–∏—Ç–∞ –æ—Ç injection –∞—Ç–∞–∫
- **Rate limit bypass prevention**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –æ–±—Ö–æ–¥–∞ –ª–∏–º–∏—Ç–æ–≤

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –°–æ–∑–¥–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

1. **`README_RATELIMIT_TESTS.md`** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **`RATELIMIT_TESTS_SUMMARY.md`** - –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
3. **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ docstrings** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –∫–æ–¥–µ
4. **Code comments** - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **`Makefile`** - –û–±–Ω–æ–≤–ª–µ–Ω —Å rate limiting –∫–æ–º–∞–Ω–¥–∞–º–∏
- **`pytest.ini`** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest –¥–ª—è rate limiting
- **`requirements-test.txt`** - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üéØ Production Readiness

### ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production

1. **Code coverage** - > 90% –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
2. **Performance** - –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
3. **Security** - –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫
4. **Scalability** - –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
5. **Reliability** - –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π
6. **Maintainability** - –õ–µ–≥–∫–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏

### CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

```yaml
# GitHub Actions example
- name: Run Rate Limiting Tests
  run: |
    make test-ratelimit-unit
    make test-ratelimit-performance  
    make test-ratelimit-security
    make test-ratelimit-coverage
```

## üîÆ –î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è ratelimit** - –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏
2. **Real Redis integration** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º Redis
3. **Distributed testing** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ
4. **Chaos engineering** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ —Å–±–æ—è–º
5. **ML-based rate limiting** - Rate limiting –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

### Performance –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **Caching strategies** - –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
2. **Connection pooling** - –ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
3. **Batch operations** - –ü–∞–∫–µ—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
4. **Async optimizations** - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### Troubleshooting

1. **Redis connection errors** - Fallback –Ω–∞ memory storage
2. **Performance degradation** - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫
3. **Memory leaks** - –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
4. **Thread safety issues** - –ê–Ω–∞–ª–∏–∑ race conditions

### –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **Issues**: –°–æ–∑–¥–∞–≤–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- **Documentation**: –ß–∏—Ç–∞–π—Ç–µ README —Ñ–∞–π–ª—ã
- **Code examples**: –ò–∑—É—á–∞–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤ —Ç–µ—Å—Ç–∞—Ö

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–æ–∑–¥–∞–Ω **comprehensive test suite** –¥–ª—è —Å–∏—Å—Ç–µ–º—ã Rate Limiting, –∫–æ—Ç–æ—Ä—ã–π:

‚úÖ **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º 1–°** —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è  
‚úÖ **–ü–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ —Ç–∏–ø—ã —Ç–µ—Å—Ç–æ–≤** (Unit, Integration, Performance, Security, etc.)  
‚úÖ **–û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç > 90% –ø–æ–∫—Ä—ã—Ç–∏–µ** –∫–æ–¥–∞  
‚úÖ **–ì–æ—Ç–æ–≤ –∫ production** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é  
‚úÖ **–í–∫–ª—é—á–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å Locust  
‚úÖ **–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç performance –±–µ–Ω—á–º–∞—Ä–∫–∏**  
‚úÖ **–ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫**  
‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç thread safety**  
‚úÖ **–ò–º–µ–µ—Ç –ø–æ–ª–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**  
‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å CI/CD**  

**–¢–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç ~3500+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞** –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç production-ready —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã Rate Limiting.

---

**–í–µ—Ä—Å–∏—è**: 1.0.0  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-10-29  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é