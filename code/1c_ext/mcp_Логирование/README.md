# Модуль структурированного JSON логирования для 1С:Предприятие

## Описание

Модуль обеспечивает структурированное JSON логирование в соответствии со стандартами обработки ошибок 1С:Предприятие и индустриальными практиками структурированного логирования.

## Основные функции

### JSON Схема логов
Модуль формирует структурированные логи в формате JSON со следующими полями:
- `timestamp` - метка времени в формате ISO 8601
- `level` - уровень логирования (INFO/WARN/ERROR/FATAL)
- `message` - текст сообщения
- `user_id` - анонимизированный идентификатор пользователя
- `request_id` - уникальный идентификатор запроса
- `correlation_id` - корреляционный идентификатор для трассировки
- `error_code` - код ошибки (если применимо)
- `http_method` - HTTP метод (для интеграций)
- `target_service` - целевой сервис
- `duration_ms` - длительность операции в миллисекундах
- `severity` - уровень серьезности
- `stacktrace` - краткий стек вызовов
- `context` - дополнительные данные
- `infobase` - имя информационной базы
- `server_name` - имя сервера 1С
- `process_id` - идентификатор процесса

### Уровни логирования
- **INFO** - информационные сообщения
- **WARN** - предупреждения
- **ERROR** - ошибки
- **FATAL** - критические ошибки

### Корреляционные ID
- Автоматическая генерация уникальных идентификаторов
- Трассировка запросов между компонентами
- Связывание логов одной операции

### Маскирование PII данных
Автоматическое маскирование конфиденциальных данных:
- Пароли и токены
- Номера кредитных карт
- Email адреса
- Персональные данные

### Интеграция с журналом регистрации
- Запись структурированных логов в журнал регистрации 1С
- Форматирование для внешних систем мониторинга
- Совместимость со стандартами 1С

## Основные процедуры

### Логирование событий
```bsl
// Информационные сообщения
ЛогироватьИнформацию("Операция выполнена успешно", Контекст);

// Предупреждения
ЛогироватьПредупреждение("Обнаружены подозрительные данные", Контекст);

// Ошибки
ЛогироватьОшибку("Не удалось подключиться к сервису", ИнфОшибки, Контекст);

// Критические ошибки
ЛогироватьКритическуюОшибку("Критическая ошибка системы", ИнфОшибки, Контекст);
```

### Работа с корреляционными ID
```bsl
// Начать новую операцию
Идентификаторы = НачатьНовуюОперацию(КонтекстОперации);

// Получить текущие корреляционные ID
ТекущиеID = ПолучитьКорреляционныеИдентификаторы();
```

### Маскирование данных
```bsl
// Маскировать конфиденциальные данные
ЗамаскированныеДанные = МаскироватьКонфиденциальныеДанные(ИсходнаяСтруктура);

// Анонимизировать пользователя
АнонимныйID = АнонимизироватьИдентификаторПользователя(ПользовательИД);
```

### Работа с JSON
```bsl
// Создать структуру лога
СтруктураЛога = СформироватьСтруктуруЛога();

// Преобразовать в JSON
JSONСтрока = ПреобразоватьСтруктуруВJSON(СтруктураЛога);
```

## Особенности реализации

### Безопасность
- Все конфиденциальные данные автоматически маскируются
- Пользователи анонимизируются с помощью хеширования
- Соответствие стандартам GDPR

### Производительность
- Минимальные накладные расходы на логирование
- Асинхронная запись в журнал регистрации
- Оптимизированное формирование JSON

### Надежность
- Обработка ошибок логирования
- Резервное логирование при сбоях
- Автоматическая инициализация модуля

## Примеры использования

### Логирование веб-сервиса
```bsl
Контекст = СоздатьКонтекстЛогирования("ЗагрузкаДанных", "ОбработчикЗагрузки");
Контекст.Вставить("file_name", ИмяФайла);

ЛогироватьИнформацию("Начата загрузка файла", Контекст);
```

### Логирование интеграции
```bsl
ЛогироватьИнтеграцию("INFO", "Запрос выполнен успешно", 
                    "POST", "ExternalAPI", "https://api.example.com/data", 
                    200, Контекст);
```

### Логирование с временными метками
```bsl
ВремяНачала = ТекущаяДатаСеанса();

// Выполнение операции...

ЛогироватьИнформацию("Операция завершена", Неопределено, ВремяНачала);
```

## Требования

- Платформа 1С:Предприятие 8.3.10 и выше
- Поддержка работы с JSON
- Доступ к журналу регистрации

## Лицензия

Стандартная лицензия 1С:Предприятие


Модуль разработан на основе современных стандартов обработки ошибок в 1С и индустриальных практик структурированного логирования.

## Версия

1.0 (2025-10-29)
