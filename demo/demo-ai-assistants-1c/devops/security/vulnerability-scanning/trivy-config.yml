# Trivy Vulnerability Scanning Configuration
format: json
exit-code: 1
severity: UNKNOWN,LOW,MEDIUM,HIGH,CRITICAL
vuln-type: os,library
security-checks: vuln,secret,config
timeout: 10m

# Ignore specific vulnerabilities (use sparingly)
ignore-unfixed: false
ignore-file: .trivyignore

# Output options
output: trivy-report.json
output-template: '{{- template "custom.report" . }}'

# Repository scanning
security-checks: vuln,secret,config
scan: 
  - {type: os}
  - {type: library}
  - {type: fs}

# Docker image scanning
image: ai-assistants/api:latest

# Git repository scanning
git-repository: https://github.com/company/ai-assistants
branch: main

# Cache options
cache: true
cache-dir: /tmp/trivy-cache

# Server mode (for CI/CD integration)
server: http://trivy-server:4954

# Database configuration
db:
  repository: ghcr.io/aquasecurity/trivy-db
  light: false
  update-cache: true

# Report format
format: json, sarif, table

# Target
target: /workspace/app

# Progress bar
quiet: false
debug: false
no-progress: false

# Logging
log-level: info
log-file: trivy.log

# Exit codes
exit-code: 1  # Exit with non-zero if vulnerabilities found
severity: CRITICAL,HIGH  # Only exit on critical and high

# Security checks
security-checks: vuln,secret,config

# Ignore unfixed
ignore-unfixed: false

# Ignore vulnerabilities in specific packages
ignore-file: .trivyignore

# SBOM generation
sbom: trivy-sbom.json

# Post-scans actions
post-actions:
  - scan
  - report
  - upload

# Notification settings
notification:
  webhook-url: http://slack-webhook.company.com/security-alerts
  channel: #security-alerts
  username: Trivy Scanner