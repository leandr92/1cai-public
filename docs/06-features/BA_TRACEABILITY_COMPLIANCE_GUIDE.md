# üõ° BA-05 Traceability & Compliance Guide

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–î–∞—Ç–∞:** –Ø–Ω–≤–∞—Ä—å 2025  
**–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:** 
- `src/ai/agents/business_analyst_agent_extended.py`
- `src/ai/agents/traceability_with_graph.py`
- `src/api/ba_sessions.py`

---

## 1. –¶–µ–ª—å BA-05

–ü–æ–º–æ—á—å BA‚Äë–∞–≥–µ–Ω—Ç—É –∑–∞–∫—Ä—ã—Ç—å –≤–æ–ø—Ä–æ—Å—ã —Ç—Ä–∞—Å—Å–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º:

- —Ä–µ–µ—Å—Ç—Ä —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π ‚Üî –∑–∞–¥–∞—á ‚Üî —Ç–µ—Å—Ç–æ–≤ ‚Üî —Ä–µ–ª–∏–∑–æ–≤ (traceability matrix);
- —Ä–µ–µ—Å—Ç—Ä —Ä–∏—Å–∫–æ–≤ —Å –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏–µ–π (risk register, heatmap);
- —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–º/–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º (compliance checklist).

---

## 2. –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **Traceability Matrix Builder**
   - –∏–∑ —Å–ø–∏—Å–∫–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∏ –∑–∞–¥–∞—á —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç:
     - —Å–≤—è–∑—å ¬´—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ ‚Üí user story ‚Üí task ‚Üí —Ç–µ—Å—Ç ‚Üí —Ä–µ–ª–∏–∑¬ª;
     - —Ç–∞–±–ª–∏—Ü—É/–º–∞—Ç—Ä–∏—Ü—É –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏ –≤ Jira/Confluence.

2. **Risk Register & Heatmap**
   - –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞/—Ñ–∏—á–∏:
     - –≤—ã–¥–µ–ª—è–µ—Ç —Ä–∏—Å–∫–∏ (–ø–æ –æ–±–ª–∞—Å—Ç—è–º: –±–∏–∑–Ω–µ—Å, —Ç–µ—Ö–¥–æ–ª–≥, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –¥–∞–Ω–Ω—ã–µ);
     - –Ω–∞–∑–Ω–∞—á–∞–µ—Ç likelihood/impact, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç risk score;
     - –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç heatmap‚Äë–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏ mitigation‚Äë–ø–ª–∞–Ω—ã.

3. **Compliance Checklist**
   - –ø–æ–º–æ–≥–∞–µ—Ç —Å–æ–±—Ä–∞—Ç—å —á–µ–∫‚Äë–ª–∏—Å—Ç –ø–æ:
     - —Ä–µ–≥—É–ª—è—Ç–æ—Ä–∏–∫–µ (152‚Äë–§–ó/GDPR –∏ —Ç.–ø. ‚Äî –Ω–∞ —É—Ä–æ–≤–Ω–µ high‚Äëlevel —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π),
     - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –ø–æ–ª–∏—Ç–∏–∫–∞–º (security, observability, DR).

---

## 3. –ö–∞–∫ —ç—Ç–æ –±—É–¥–µ—Ç –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å—Å—è

- BA‚Äë–∞–≥–µ–Ω—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç:
  - —Å–ø–∏—Å–æ–∫ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π/—Ñ–∏—á (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ BA‚Äë02),
  - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ—Å—Ç–∞—Ö/—Ä–µ–ª–∏–∑–∞—Ö (–≤ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–µ ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Jira/CI),
  - –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–∏–∫–µ/–ø–æ–ª–∏—Ç–∏–∫–∞–º.
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
  - traceability matrix (JSON/—Ç–∞–±–ª–∏—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ),
  - risk register —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ –∏ mitigation,
  - draft compliance‚Äë—á–µ–∫‚Äë–ª–∏—Å—Ç.

---

## 4. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### ‚úÖ Traceability Matrix —Å Unified Change Graph

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `TraceabilityWithGraph` (`src/ai/agents/traceability_with_graph.py`), –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Unified Change Graph –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ traceability:

- **requirements ‚Üí code** (—á–µ—Ä–µ–∑ `IMPLEMENTS`)
- **code ‚Üí tests** (—á–µ—Ä–µ–∑ `TESTED_BY`)
- **code ‚Üí incidents** (—á–µ—Ä–µ–∑ `TRIGGERS_INCIDENT`)

### ‚úÖ Risk Register & Heatmap

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ Risk Register –Ω–∞ –æ—Å–Ω–æ–≤–µ:
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π ‚Üí **high risk**
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–¥–∞, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ ‚Üí **high risk**
- –ù–∞–ª–∏—á–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ–º ‚Üí **high risk**
- –¢–æ–ª—å–∫–æ –∫–æ–¥ –±–µ–∑ —Ç–µ—Å—Ç–æ–≤ ‚Üí **high risk**
- –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã –±–µ–∑ –∫–æ–¥–∞ ‚Üí **medium risk**

### ‚úÖ Compliance Status

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ compliance status:
- **compliant** ‚Äî –≤—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏–º–µ—é—Ç –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (–∫–æ–¥ + —Ç–µ—Å—Ç—ã)
- **partially_compliant** ‚Äî –µ—Å—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å —á–∞—Å—Ç–∏—á–Ω—ã–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º
- **non_compliant** ‚Äî –µ—Å—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±–µ–∑ –ø–æ–∫—Ä—ã—Ç–∏—è

### ‚úÖ API Endpoints

–î–æ–±–∞–≤–ª–µ–Ω—ã REST API endpoints –≤ `src/api/ba_sessions.py`:

- `POST /ba-sessions/traceability/matrix` ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å traceability matrix
- `POST /ba-sessions/traceability/risk-register` ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å Risk Register
- `POST /ba-sessions/traceability/full-report` ‚Äî –ø–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç traceability & compliance

## 5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### Python API

```python
from src.ai.agents.business_analyst_agent_extended import BusinessAnalystAgentExtended

agent = BusinessAnalystAgentExtended()

requirements = [
    {"id": "REQ001", "title": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 1"},
    {"id": "REQ002", "title": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 2"},
]
test_cases = []

# –ü–æ—Å—Ç—Ä–æ–∏—Ç—å traceability & risks —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≥—Ä–∞—Ñ–∞
result = await agent.build_traceability_and_risks(
    requirements,
    test_cases,
    use_graph=True,  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Unified Change Graph
)

# –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
# - traceability: –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–æ—Å–ª–µ–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏
# - risk_register: —Ä–µ–µ—Å—Ç—Ä —Ä–∏—Å–∫–æ–≤
# - risk_heatmap: –∫–∞—Ä—Ç–∞ —Ä–∏—Å–∫–æ–≤ (high/medium/low)
# - compliance: —Å—Ç–∞—Ç—É—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
```

### REST API

```bash
# –ü–æ—Å—Ç—Ä–æ–∏—Ç—å traceability matrix
curl -X POST http://localhost:8000/ba-sessions/traceability/matrix \
    -H "Content-Type: application/json" \
    -d '{
        "requirement_ids": ["REQ001", "REQ002"],
        "include_code": true,
        "include_tests": true,
        "use_graph": true
    }'

# –ü–æ—Å—Ç—Ä–æ–∏—Ç—å Risk Register
curl -X POST http://localhost:8000/ba-sessions/traceability/risk-register \
    -H "Content-Type: application/json" \
    -d '{
        "requirement_ids": ["REQ001", "REQ002"],
        "include_incidents": true
    }'

# –ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç
curl -X POST http://localhost:8000/ba-sessions/traceability/full-report \
    -H "Content-Type: application/json" \
    -d '{
        "requirement_ids": ["REQ001", "REQ002"]
    }'
```

## 6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Unified Change Graph

BA-05 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Unified Change Graph –¥–ª—è:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏, –∫–æ–¥–æ–º, —Ç–µ—Å—Ç–∞–º–∏ –∏ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞–º–∏
- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏ traceability –±–µ–∑ —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- Impact-–∞–Ω–∞–ª–∏–∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

–ï—Å–ª–∏ –≥—Ä–∞—Ñ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∞–∑–æ–≤—ã–π `TraceabilityMatrixGenerator` (fallback).

## 7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å unit-—Ç–µ—Å—Ç—ã
pytest tests/unit/test_traceability_with_graph.py -v
pytest tests/unit/test_ba_traceability_api.py -v
```

## 8. –°–º. —Ç–∞–∫–∂–µ

- [`BUSINESS_ANALYST_GUIDE.md`](BUSINESS_ANALYST_GUIDE.md) ‚Äî –æ–±—â–∏–π –≥–∞–π–¥ –ø–æ BA –∞–≥–µ–Ω—Ç—É
- [`CODE_GRAPH_REFERENCE.md`](../architecture/CODE_GRAPH_REFERENCE.md) ‚Äî —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è Unified Change Graph
- [`1C_CODE_GRAPH_BUILDER_GUIDE.md`](1C_CODE_GRAPH_BUILDER_GUIDE.md) ‚Äî –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –∏–∑ –∫–æ–¥–∞ 1–°


