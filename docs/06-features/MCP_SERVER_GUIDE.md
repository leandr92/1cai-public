# MCP Server Guide

> –û–±–Ω–æ–≤–ª–µ–Ω–æ: 19 –Ω–æ—è–±—Ä—è 2025

## 1. –û–±–∑–æ—Ä

MCP —Å–µ—Ä–≤–µ—Ä (`src/ai/mcp_server.py`) —Ä–µ–∞–ª–∏–∑—É–µ—Ç Model Context Protocol –¥–ª—è IDE (Cursor, VS Code, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è EDT). –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω—ã–π HTTP-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –Ω–∞–±–æ—Ä–æ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (tools), –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑—ã–≤–∞—é—Ç AI-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä, —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö (Neo4j, Qdrant) –∏ –≤–Ω–µ—à–Ω–∏–µ MCP-—Å–µ—Ä–≤–∏—Å—ã.

–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –∫–∞—Ç–∞–ª–æ–≥ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (`/mcp/tools`) —Å –æ–ø–∏—Å–∞–Ω–Ω—ã–º–∏ —Å—Ö–µ–º–∞–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤;
- –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –≤—ã–∑–æ–≤–æ–≤ –Ω–∞ AI Orchestrator –∏ –≤–Ω–µ—à–Ω–∏–µ MCP;
- —Ä–∞–±–æ—Ç–∞ —á–µ—Ä–µ–∑ FastAPI + Uvicorn (–ø–æ—Ä—Ç 6001 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é);
- –ø–æ–¥–¥–µ—Ä–∂–∫–∞ IDE-–ø–ª–∞–≥–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç MCP.

### üîç –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–Ω–µ—à–Ω–∏—Ö MCP —Å–µ—Ä–≤–µ—Ä–æ–≤

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –≤–Ω–µ—à–Ω–∏–º–∏ MCP —Å–µ—Ä–≤–µ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏-—Å–ª–æ–π. –ü—Ä–æ–≤–µ–¥—ë–Ω –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö MCP —Å–µ—Ä–≤–µ—Ä–æ–≤:

- **üìö [–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç–∏ MCP —Å–µ—Ä–≤–µ—Ä–æ–≤](../research/MCP_SERVERS_APPLICABILITY_ANALYSIS.md)** ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ 5 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö MCP —Å–µ—Ä–≤–µ—Ä–æ–≤ (Context7, Exa, GitHub, Chroma, Atlassian) —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
- üü¢ **MCP Atlassian** ‚Äî –æ—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å (—É–ø—Ä–æ—Å—Ç–∏—Ç Business Analyst Agent)
- üü¢ **Context7** ‚Äî –≤—ã—Å–æ–∫–∞—è –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å (–∞–∫—Ç—É–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫)
- üü¢ **GitHub MCP** ‚Äî –≤—ã—Å–æ–∫–∞—è –ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è GitHub –æ–ø–µ—Ä–∞—Ü–∏–π)

## 2. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í–µ—Ä—Å–∏—è/–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|--------------------|
| Python | 3.11.x (—Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ `src/main.py`) |
| FastAPI + Uvicorn | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `requirements.txt` |
| Graph API | –ù—É–∂–µ–Ω –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å Neo4j/Qdrant |
| Docker Compose | –î–ª—è –ø–æ–¥–Ω—è—Ç–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (`make docker-up`) |
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `.env` | –ö–ª—é—á–∏ OpenAI, Supabase, –ë–î, Redis, –≤–Ω–µ—à–Ω–∏–µ MCP |

## 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

### –ß–µ—Ä–µ–∑ Makefile (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ)
```bash
make docker-up     # –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
make migrate       # –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
make servers       # —Å—Ç–∞—Ä—Ç Graph API (8080) –∏ MCP —Å–µ—Ä–≤–µ—Ä–∞ (6001)
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ (PowerShell / –±–µ–∑ make)
```powershell
python -m uvicorn src.main:app --host 0.0.0.0 --port 8080   # Graph API
python -m src.ai.mcp_server --host 0.0.0.0 --port 6001       # MCP —Å–µ—Ä–≤–µ—Ä
```
> –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `.env` –∑–∞–¥–∞–Ω—ã –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (OpenAI, Supabase, –ë–î).

## 4. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ IDE

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `http://localhost:6001/mcp` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON c –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–µ—Ä–≤–µ—Ä–µ.
2. –í Cursor/VS Code –¥–æ–±–∞–≤—å—Ç–µ MCP endpoint:
   - URL: `http://localhost:6001/mcp`
   - –ò–º—è: `1C AI Stack`
3. –î–ª—è –ø–ª–∞–≥–∏–Ω–∞ EDT –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç—É –∂–µ –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É; —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Graph API (8080) –∏ MCP (6001) –¥–æ—Å—Ç—É–ø–Ω—ã –∏–∑ —Å—Ä–µ–¥—ã EDT.
4. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ IDE –∑–∞–ø—Ä–æ—Å–∏—Ç —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `/mcp/tools` –æ—Ç–≤–µ—á–∞–µ—Ç —Å–ø–∏—Å–∫–æ–º (—Å–º. —Ç–∞–±–ª–∏—Ü—É –Ω–∏–∂–µ).

## 5. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã MCP

| –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ê—Ä–≥—É–º–µ–Ω—Ç—ã |
|----------|----------|-----------|
| `search_metadata` | –ü–æ–∏—Å–∫ –æ–±—ä–µ–∫—Ç–æ–≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö 1–° —á–µ—Ä–µ–∑ Neo4j –≥—Ä–∞—Ñ. | `query` (–æ–±—è–∑.), `configuration`, `object_type` |
| `search_code_semantic` | –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É (Qdrant). | `query` (–æ–±—è–∑.), `configuration`, `limit` |
| `generate_bsl_code` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è BSL –∫–æ–¥–∞ (Qwen3-Coder). | `description` (–æ–±—è–∑.), `function_name`, `parameters`, `context` |
| `analyze_dependencies` | –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Ñ—É–Ω–∫—Ü–∏–π/–º–æ–¥—É–ª–µ–π. | `module_name` (–æ–±—è–∑.), `function_name` (–æ–±—è–∑.) |
| `bsl_platform_context` | –ü—Ä–æ–∫—Å–∏ –∫ –≤–Ω–µ—à–Ω–µ–º—É MCP alkoleft/mcp-bsl-platform-context. | `query` (–æ–±—è–∑.), `scope` |
| `bsl_test_runner` | –ü—Ä–æ–∫—Å–∏ –∫ –≤–Ω–µ—à–Ω–µ–º—É MCP alkoleft/mcp-onec-test-runner. | `workspace` (–æ–±—è–∑.), `testPlan`, `arguments` |

–ö–∞–∂–¥—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç `AIOrchestrator.process_query`, –ø–µ—Ä–µ–¥–∞–≤–∞—è —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç.

## 6. –í–Ω–µ—à–Ω–∏–µ MCP –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|------------|------------|--------|
| `MCP_BSL_CONTEXT_BASE_URL` | –ë–∞–∑–æ–≤—ã–π URL —Å–µ—Ä–≤–µ—Ä–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. | `http://localhost:7001` |
| `MCP_BSL_CONTEXT_TOOL_NAME` | –ò–º—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –Ω–∞ –≤–Ω–µ—à–Ω–µ–º —Å–µ—Ä–≤–µ—Ä–µ. | `platform_context` |
| `MCP_BSL_CONTEXT_AUTH_TOKEN` | Bearer-—Ç–æ–∫–µ–Ω (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è). | `Bearer ...` |
| `MCP_BSL_TEST_RUNNER_BASE_URL` | –ë–∞–∑–æ–≤—ã–π URL —Ç–µ—Å—Ç-—Ä–∞–Ω–Ω–µ—Ä–∞. | `http://localhost:7002` |
| `MCP_BSL_TEST_RUNNER_TOOL_NAME` | –ò–º—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –Ω–∞ —Ç–µ—Å—Ç-—Ä–∞–Ω–Ω–µ—Ä–µ. | `run_tests` |
| `MCP_BSL_TEST_RUNNER_AUTH_TOKEN` | –¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ). | `Bearer ...` |

–ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –∑–∞–¥–∞–Ω–∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤–µ—Ä–Ω—ë—Ç –æ—à–∏–±–∫—É `configured=False`.

## 7. –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø–∏—à—É—Ç –ª–æ–≥–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –∑–∞–¥–∞–Ω–Ω—É—é `log_dir` (`./logs` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
- MCP —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `logging`; –Ω–∞ –ø—Ä–æ–¥ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–æ—Ç–∞—Ü–∏—é —Ñ–∞–π–ª–æ–≤ –∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–±–æ—Ä.
- –î–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –≤—ã–∑–æ–≤–æ–≤ —Å–º–æ—Ç—Ä–∏—Ç–µ —É—Ä–æ–≤–µ–Ω—å INFO –≤ `src/ai/mcp_server.py` (`MCP tool called: ...`).

## 8. Troubleshooting

| –°–∏–º–ø—Ç–æ–º | –í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|---------|-------------------|---------|
| `Connection refused` –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ `/mcp` | MCP —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω / –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç | –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ `make servers` –∏–ª–∏ `python -m src.ai.mcp_server`, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–µ—Ä–≤–æ–ª |
| `Tool not found` –≤ –æ—Ç–≤–µ—Ç–µ | IDE –æ—Ç–ø—Ä–∞–≤–∏–ª–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–º—è | –û–±–Ω–æ–≤–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (`/mcp/tools`), –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é IDE |
| –û—à–∏–±–∫–∞ `configured=False` | –í–Ω–µ—à–Ω–∏–π MCP –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω | –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å–µ—Ä–≤–∏—Å (—Å–º. README) –∏ –∑–∞–¥–∞–π—Ç–µ URL/—Ç–æ–∫–µ–Ω |
| 5xx –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ | –û—à–∏–±–∫–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏–ª–∏ –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Graph API / –≤–Ω–µ—à–Ω–∏—Ö MCP, —É–±–µ–¥–∏—Ç–µ—Å—å –≤ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Neo4j –∏ Qdrant |

## 9. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–∞–≤–∏–ª–∞

- –ü—É–±–ª–∏–∫—É—è —ç–Ω–¥–ø–æ–∏–Ω—Ç, —É–±–µ–¥–∏—Ç–µ—Å—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ CORS –∏ rate limiting (—Å–º. `src/security`, –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ `docs/research/constitution.md`).
- –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –∏ —Å–µ–∫—Ä–µ—Ç—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏; –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env` (—Å–º. `.gitignore`).
- –î–ª—è –ø—Ä–æ–¥ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (JWT) –∏ HTTPS-–ø–µ—Ä–µ–¥–∞—á—É.

## 10. –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- [alkoleft/mcp-bsl-platform-context](https://github.com/alkoleft/mcp-bsl-platform-context) ‚Äî –≤–Ω–µ—à–Ω–∏–π MCP –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
- [alkoleft/mcp-onec-test-runner](https://github.com/alkoleft/mcp-onec-test-runner) ‚Äî MCP –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤.
- –°–æ–æ–±—â–µ—Å—Ç–≤–æ MCP –∏ GitHub Spec Kit ‚Äî –∑–∞ –ø—Ä–∏–º–µ—Ä—ã —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.
