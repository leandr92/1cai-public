# On-call Rotations & Incident Response

## 1. Цели
- Обеспечить круглосуточную поддержку критичных сервисов.
- Сократить MTTR и повысить прозрачность инцидентов.

## 2. Роли
- **Primary on-call**: отвечает за инциденты в текущую смену.
- **Secondary**: страхует primary, берет сложные кейсы.
- **Manager/Lead**: координирует после окончания инцидента, следит за выполнением follow-up.

## 3. Расписание
- Смена 1 неделя (пн 09:00 — пн 09:00). Используйте общий календарь (Google/Outlook). При смене ответственности проводить handoff.
- В будни 09:00–18:00 доступен основной инженер разработки (не on-call) для консультаций.

## 4. Регламент действий
1. **Поступил алерт** (Pager/Slack): Primary подтверждает (ack) ≤5 минут.
2. **Классификация**:
   - P0 — полный простой core сервисов (API, Vault, Linkerd) → незамедлительное реагирование, подключаем Secondary.
   - P1 — деградация важного функционала → реагируем ≤15 минут.
   - P2 — minor issues → в рабочее время.
3. **Коммуникация**: все шаги фиксируем в канал #incident-<date> (Slack/Teams). Для P0 — уведомить Stakeholder list (email/Teams).
4. **Логирование**: вести timeline, участвующих, принятые меры.
5. **Escalation**: если нет решения за 30 минут — подключить Manager/Lead.

## 5. После инцидента
- В течение 24 часов подготовить постмортем (`docs/runbooks/postmortem_template.md`).
- Создать follow-up задачи и закрепить владельцев.
- Вынести изменения в документацию (SLO, runbooks, архитектура).
- Добавить сценарии в `docs/runbooks/dr_rehearsal_plan.md` (если требуется rehearsal).

## 6. Инструменты
- PagerDuty / Opsgenie (TODO): интеграция с Slack/Teams.
- Slack канал `#oncall` + `#incident-YYYYMMDD` (создается автоматически в будущем). Использовать `make preflight` результаты для проверки.
- Grafana/FinOps dashboards, Vault audit logs.

## 7. TODO
- Интеграция с PagerDuty API (автоматическое назначение смен).
- Автоматический экспорт “incident report” в Confluence/Docs.
- Синхронизировать календарь с HR/Отпусками.
