# Конституция 1C AI Stack

> Обновлено: 2025-11-11

## Критические правила проверки

1. **Никаких «всё хорошо» без полной автоматизированной проверки** — перед релизом/PR запускаем все связанные скрипты и CI.
2. **Всегда использовать скрипты и автоматизацию** — никакой «ручной» проверки; если шаг не автоматизирован, фиксируем это как проблему.
3. **Проверять 100% файлов** — анализ, поиск ссылок, соответствие путей.
4. **Каждая ссылка в документации → валидная** — регулярный link-checker (README, docs).
5. **Пути к файлам — реальные** — упоминание файла обязано соответствовать существующему пути.
6. **Думать как новичок** — проверять инструкции от лица нового участника (установка Python, make, Docker).
7. **Прозрачность** — любые проблемы/риски перечисляются честно.
8. **Не останавливаемся, пока проблемы ≠ 0 или итоговая оценка < A** — исправляем, документируем.
9. **Оценки — реалистичные** — без оптимизма, основаны на фактах и тестах.
10. **Любой файл из инструкций должен существовать** — проверка перед публикацией.
11. **Проверять корректность путей** — пользователи не должны искать файлы по неверным путям.
12. **Каждый компонент в README → документ в `docs/`** (см. `docs/06-features/`).
13. **`### Feature X` → `docs/06-features/FEATURE_X_GUIDE.md`** — stub или подробный документ.
14. **Технологии в README — присутствуют в `src/`** — никаких “планируемых” фич в продакшен-описании.
15. **Планируемые фичи = planned** — не выдаём за production (правильное wording).
16. **`requirements*.txt` → пакеты существуют на PyPI** — проверка перед релизом.
17. **Нет приватных данных** — никаких `C:\Users\...`, токенов, конфигураций.
18. **Нет hard-coded секретов** — проверка по шаблонам (`sk-`, `ghp_`, `API_KEY=` и т.д.).
19. **CORS настройки** — потенциально опасные (`*`) обсуждаются и фиксируются.
20. **Rate limiting на чувствительных эндпоинтах** (`/generate`, `/create`, `/upload`).
21. **SQL-инъекции** — никакого `f"..."` в `execute()`/`fetch`.
22. **Проверка зависимостей на CVE** — регулярные сканеры (pip-audit/poetry). 
23. **`.gitignore` закрывает секреты** — `.env`, `*.key`, `*.pem`, `secrets/` и т.п.
24. **Внешние API — с таймаутами**.
25. **Pydantic строки → `max_length`** (и другие ограничения).
26. **Проверять скрытые папки (`.foo`)** — возможны sensitive данные.
27. **Запуск скриптов под минимальными правами** — никакого `sudo`/admin без необходимости; PowerShell/Unix скрипты выполняем от ограниченного пользователя.
28. **Secret scanning** — workflows `secret-scan.yml` (Gitleaks), `trufflehog.yml` и `docs-lint.yml` должны быть зелёными перед merge/release.
29. **Release-only через automation** — релизы создаём `scripts/release/create_release.py` + workflow `release.yml`; никаких ручных GitHub Releases.
30. **DORA и наблюдаемость** — workflow `dora-metrics.yml` не должен пропускаться; анализ метрик фиксируется в weekly summary.
31. **Python runtime** — перед запуском сервисов выполняем `make check-runtime`; Python 3.11.x обязателен для API/MCP, скрипт дополнительно предупреждает об отсутствии `make` и `docker` в PATH.
32. **Policy-as-Code** — `make policy-check` (Conftest + Semgrep) и CI стадии (Jenkins/GitLab) обязаны проходить перед merge/release; исключения документируются.
33. **Operational self-check** — перед деплоем выполняем `make preflight` (lint/test/policy/checkov) и фиксируем результаты в issue/PR.

## Процесс

- Конституция хранится в репозитории и актуализируется при изменении процессов.
- Любые AI-агенты (MCP, Claude, Copilot) обязаны ориентироваться на этот документ.
- Перед релизом/PR проверяем, что все правила выполнены либо задокументированы исключения.
