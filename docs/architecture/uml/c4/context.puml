@startuml context
!include <C4/C4_Context>

LAYOUT_LEFT_RIGHT()
LAYOUT_WITH_LEGEND()

AddElementTag("External","#f8f9fa","")
AddElementTag("Platform","#e8f4ff","")

Person(Developer, "1C Developers", "Work in 1C:EDT with AI assisted tooling.", "External")
Person(DevOps, "Ops and DevOps", "Maintain deployments, infrastructure and SLAs.", "External")
Person(Support, "1C IT Staff", "Operate support workflows, Telegram, FAQ.", "External")
System_Ext(ITS, "ITS Portal", "Official 1C documentation portal.")
System_Ext(AIProviders, "External AI Providers", "OpenAI, Qwen, local LLMs.")

System_Boundary(OneCAIStack, "1C AI Stack", "Platform") {
  System(API, "Graph API", "FastAPI", "GraphQL, REST, MCP endpoints for IDE and automations.")
  System(Workers, "Analysis Workers", "Celery, AsyncIO", "Code analysis, audits, orchestrated tasks.")
  System(ML, "ML Pipelines", "PyTorch, Transformers", "Training, evaluation, inference workflows.")
  System(Integrations, "Integrations Hub", "n8n, Telegram, Marketplace", "External touchpoints and developer tooling.")
  System(Monitoring, "Observability Stack", "Prometheus, Grafana, Alertmanager", "Metrics, logging, alerting, SLO tracking.")
}

Rel(Developer, API, "Requests analysis, AI assistance", "REST / MCP")
Rel(Developer, Integrations, "Triggers automation workflows", "n8n, Telegram")
Rel(Support, Integrations, "Consumes ITS data, FAQ", "HTTPS")
Rel(Support, API, "Manages admin portal", "Web UI")
Rel(DevOps, Monitoring, "Observes metrics, alerts")
Rel(DevOps, API, "Automates deployments, smoke tests", "CI/CD")
Rel(ITS, Integrations, "Provides documentation dumps", "HTTPS")
Rel(AIProviders, ML, "Serve models and embeddings", "gRPC / HTTPS")

Rel(API, Workers, "Dispatches jobs", "Redis / Celery")
Rel(Workers, ML, "Feeds datasets, triggers pipelines")
Rel(Workers, Monitoring, "Publishes metrics and traces")
Rel(API, Monitoring, "Exposes request metrics")
Rel(Integrations, Monitoring, "Reports channel health")

SHOW_LEGEND()
@enduml

