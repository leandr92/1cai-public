// Icon Generator Utility for PWA
// Creates SVG icons for various sizes

const createIconSVG = (size, gradientFrom = '#3b82f6', gradientTo = '#8b5cf6', icon = 'üèóÔ∏è') => `
<svg width="${size}" height="${size}" viewBox="0 0 ${size} ${size}" fill="none" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:${gradientFrom};stop-opacity:1" />
      <stop offset="100%" style="stop-color:${gradientTo};stop-opacity:1" />
    </linearGradient>
  </defs>
  <rect width="${size}" height="${size}" rx="${size * 0.2}" fill="url(#gradient)"/>
  <circle cx="${size/2}" cy="${size/2}" r="${size*0.25}" fill="rgba(255,255,255,0.2)"/>
  <text x="50%" y="50%" font-size="${size*0.4}" text-anchor="middle" dy=".3em" fill="white">${icon}</text>
</svg>`;

// Generate and download icon
function generateIcon(size, gradientFrom, gradientTo, icon, filename) {
  const svg = createIconSVG(size, gradientFrom, gradientTo, icon);
  const blob = new Blob([svg], { type: 'image/svg+xml' });
  const url = URL.createObjectURL(blob);
  
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// Generate all required PWA icons
function generateAllIcons() {
  const icons = [
    { size: 16, name: 'icon-16x16.png' },
    { size: 32, name: 'icon-32x32.png' },
    { size: 72, name: 'icon-72x72.png' },
    { size: 96, name: 'icon-96x96.png' },
    { size: 128, name: 'icon-128x128.png' },
    { size: 144, name: 'icon-144x144.png' },
    { size: 152, name: 'icon-152x152.png' },
    { size: 167, name: 'icon-167x167.png' },
    { size: 180, name: 'icon-180x180.png' },
    { size: 192, name: 'icon-192x192.png' },
    { size: 384, name: 'icon-384x384.png' },
    { size: 512, name: 'icon-512x512.png' }
  ];
  
  // Create basic PWA icon
  icons.forEach(({ size, name }) => {
    generateIcon(size, '#3b82f6', '#8b5cf6', 'üèóÔ∏è', name);
  });
  
  // Create role-specific icons
  const roles = [
    { icon: 'üèóÔ∏è', from: '#3b82f6', to: '#1d4ed8', name: 'architect' },
    { icon: 'üíª', from: '#10b981', to: '#059669', name: 'developer' },
    { icon: 'üìä', from: '#8b5cf6', to: '#7c3aed', name: 'pm' },
    { icon: 'üìã', from: '#f59e0b', to: '#d97706', name: 'ba' },
    { icon: 'üìà', from: '#06b6d4', to: '#0891b2', name: 'data-analyst' }
  ];
  
  roles.forEach(role => {
    [96, 128, 152, 180].forEach(size => {
      generateIcon(size, role.from, role.to, role.icon, `${role.name}-${size}x${size}.png`);
    });
  });
}

// BrowserConfig for Microsoft
const browserConfig = `<?xml version="1.0" encoding="utf-8"?>
<browserconfig>
    <msapplication>
        <tile>
            <square150x150logo src="/icons/icon-150x150.png"/>
            <wide310x150logo src="/icons/icon-310x150.png"/>
            <square310x310logo src="/icons/icon-310x310.png"/>
            <TileColor>#0f172a</TileColor>
        </tile>
    </msapplication>
</browserconfig>`;

// Generate browserconfig.xml
function generateBrowserConfig() {
  const blob = new Blob([browserConfig], { type: 'application/xml' });
  const url = URL.createObjectURL(blob);
  
  const a = document.createElement('a');
  a.href = url;
  a.download = 'browserconfig.xml';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// Auto-generate on page load if in development
if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
  document.addEventListener('DOMContentLoaded', () => {
    console.log('üèóÔ∏è PWA Icons Generator loaded');
    console.log('Run generateAllIcons() to create icons');
    console.log('Run generateBrowserConfig() to create browserconfig.xml');
  });
}

// Export for use in other files
window.PWAIconGenerator = {
  generateIcon,
  generateAllIcons,
  generateBrowserConfig
};
