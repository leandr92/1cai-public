<!DOCTYPE html>
<html>
<head>
    <title>Form Test</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Test Form</h1>
    <div id="status"></div>
    <script>
        const supabaseUrl = 'https://cdisushwdolpuvripuov.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNkaXN1c2h3ZG9scHV2cmlwdW92Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE5NjIwNTIsImV4cCI6MjA3NzUzODA1Mn0.OFmtq9dGb90uSMZpToPnEX_Tl1nuDlhQBb5bm_WcdtU';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
        
        async function testWorkflow() {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = 'Testing...';
            
            try {
                const { data, error } = await supabase.functions.invoke('workflow-orchestrator', {
                    body: {
                        user_task: 'Создать отчет по продажам',
                        user_id: 'a0f7c9f0-1234-4567-8901-234567890123',
                        demo_type: 'quick'
                    }
                });
                
                statusDiv.innerHTML = '<h2>Response:</h2><pre>' + JSON.stringify(data || error, null, 2) + '</pre>';
            } catch (err) {
                statusDiv.innerHTML = '<h2>Error:</h2><pre>' + err.message + '</pre>';
            }
        }
        
        testWorkflow();
    </script>
</body>
</html>
