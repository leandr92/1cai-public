<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<!-- 
  1C AI Assistant EDT Plugin
  Enterprise 1C AI Development Stack
-->
<plugin>
   <extension point="org.eclipse.ui.views">
      <!-- AI Assistant View -->
      <view
         id="com.1cai.edt.views.AIAssistant"
         name="AI Assistant"
         icon="icons/ai-assistant.png"
         category="com.1cai.edt.category"
         class="com.1cai.edt.views.AIAssistantView"
         allowMultiple="false">
      </view>
      
      <!-- Metadata Graph View -->
      <view
         id="com.1cai.edt.views.MetadataGraph"
         name="Metadata Graph"
         icon="icons/graph.png"
         category="com.1cai.edt.category"
         class="com.1cai.edt.views.MetadataGraphView"
         allowMultiple="false">
      </view>
      
      <!-- Semantic Search View -->
      <view
         id="com.1cai.edt.views.SemanticSearch"
         name="Semantic Search"
         icon="icons/search.png"
         category="com.1cai.edt.category"
         class="com.1cai.edt.views.SemanticSearchView"
         allowMultiple="false">
      </view>
      
   <!-- Code Optimizer View -->
   <view
      id="com.1cai.edt.views.CodeOptimizer"
      name="Code Optimizer"
      icon="icons/optimize.png"
      category="com.1cai.edt.category"
      class="com.1cai.edt.views.CodeOptimizerView"
      allowMultiple="false">
   </view>
   
   <!-- Analysis Dashboard View (NEW) -->
   <view
      id="com.1cai.edt.views.AnalysisDashboard"
      name="Analysis Dashboard"
      icon="icons/dashboard.png"
      category="com.1cai.edt.category"
      class="com.1cai.edt.views.AnalysisDashboardView"
      allowMultiple="false">
   </view>
</extension>
   
   <!-- View Category -->
   <extension point="org.eclipse.ui.views">
      <category
         id="com.1cai.edt.category"
         name="1C AI Assistant">
      </category>
   </extension>
   
   <!-- Context Menu Actions for BSL Editor -->
   <extension point="org.eclipse.ui.popupMenus">
      <objectContribution
         id="com.1cai.edt.actions.bsl"
         objectClass="com._1c.g5.v8.dt.bsl.model.Method">
         
         <action
            id="com.1cai.edt.actions.analyzeFunction"
            label="Analyze with AI"
            icon="icons/analyze.png"
            class="com.1cai.edt.actions.AnalyzeFunctionAction"
            menubarPath="additions">
         </action>
         
         <action
            id="com.1cai.edt.actions.optimizeFunction"
            label="Optimize Function"
            icon="icons/optimize.png"
            class="com.1cai.edt.actions.OptimizeFunctionAction"
            menubarPath="additions">
         </action>
         
         <action
            id="com.1cai.edt.actions.findSimilar"
            label="Find Similar Code"
            icon="icons/search.png"
            class="com.1cai.edt.actions.FindSimilarCodeAction"
            menubarPath="additions">
         </action>
         
      <action
         id="com.1cai.edt.actions.showCallGraph"
         label="Show Call Graph"
         icon="icons/graph.png"
         class="com.1cai.edt.actions.ShowCallGraphAction"
         menubarPath="additions">
      </action>
      
      <action
         id="com.1cai.edt.actions.quickAnalysis"
         label="Quick Analysis"
         icon="icons/quick-analysis.png"
         class="com.1cai.edt.actions.QuickAnalysisAction"
         menubarPath="additions"
         tooltip="Быстрый анализ функции (Ctrl+Alt+Q)">
      </action>
   </objectContribution>
</extension>
   
<!-- Main Menu Contribution (NEW) -->
<extension point="org.eclipse.ui.actionSets">
   <actionSet
      id="com.1cai.edt.actionSet"
      label="1C AI Assistant"
      visible="true">
      
      <!-- Main Menu -->
      <menu
         id="com.1cai.edt.menu"
         label="1C AI Assistant">
         <separator name="analysis"/>
         <separator name="generation"/>
         <separator name="tools"/>
      </menu>
      
      <!-- Run Analysis Actions -->
      <action
         id="com.1cai.edt.actions.runFullAnalysis"
         label="Run Full Analysis"
         menubarPath="com.1cai.edt.menu/analysis"
         class="com.1cai.edt.actions.RunFullAnalysisAction"
         tooltip="Запустить полный анализ конфигурации (6 шагов)">
      </action>
      
      <action
         id="com.1cai.edt.actions.runQuickAnalysis"
         label="Quick Analysis (Parse Only)"
         menubarPath="com.1cai.edt.menu/analysis"
         class="com.1cai.edt.actions.RunQuickAnalysisAction"
         tooltip="Быстрый анализ (только парсинг)">
      </action>
      
      <action
         id="com.1cai.edt.actions.refreshDependencies"
         label="Refresh Dependencies"
         menubarPath="com.1cai.edt.menu/analysis"
         class="com.1cai.edt.actions.RefreshDependenciesAction"
         tooltip="Обновить граф зависимостей">
      </action>
      
      <action
         id="com.1cai.edt.actions.updateBestPractices"
         label="Update Best Practices"
         menubarPath="com.1cai.edt.menu/analysis"
         class="com.1cai.edt.actions.UpdateBestPracticesAction"
         tooltip="Обновить анализ best practices">
      </action>
      
      <!-- Code Generation -->
      <action
         id="com.1cai.edt.actions.generateCode"
         label="Generate Code..."
         menubarPath="com.1cai.edt.menu/generation"
         class="com.1cai.edt.actions.GenerateCodeAction"
         tooltip="Мастер генерации кода">
      </action>
   </actionSet>
</extension>
   
<!-- Commands for keyboard shortcuts -->
<extension point="org.eclipse.ui.commands">
   <command
      id="com.1cai.edt.commands.openAIAssistant"
      name="Open AI Assistant"
      description="Открыть AI Assistant view">
   </command>
   <command
      id="com.1cai.edt.commands.semanticSearch"
      name="Open Semantic Search"
      description="Открыть Semantic Search view">
   </command>
   <command
      id="com.1cai.edt.commands.quickAnalysis"
      name="Quick Analysis"
      description="Быстрый анализ текущей функции">
   </command>
   <command
      id="com.1cai.edt.commands.optimize"
      name="Optimize Code"
      description="Открыть Code Optimizer для AI оптимизации">
   </command>
</extension>

<!-- Command handlers -->
<extension point="org.eclipse.ui.handlers">
   <handler
      commandId="com.1cai.edt.commands.openAIAssistant"
      class="com.onecai.edt.handlers.OpenAIAssistantHandler">
   </handler>
   <handler
      commandId="com.1cai.edt.commands.semanticSearch"
      class="com.onecai.edt.handlers.SemanticSearchHandler">
   </handler>
   <handler
      commandId="com.1cai.edt.commands.quickAnalysis"
      class="com.onecai.edt.handlers.QuickAnalysisHandler">
   </handler>
   <handler
      commandId="com.1cai.edt.commands.optimize"
      class="com.onecai.edt.handlers.OptimizeCodeHandler">
   </handler>
</extension>

<!-- Key Bindings (NEW) -->
<extension point="org.eclipse.ui.bindings">
   <key
      commandId="com.1cai.edt.commands.openAIAssistant"
      schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
      sequence="Ctrl+Alt+A">
   </key>
   
   <key
      commandId="com.1cai.edt.commands.semanticSearch"
      schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
      sequence="Ctrl+Alt+S">
   </key>
   
   <key
      commandId="com.1cai.edt.commands.quickAnalysis"
      schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
      sequence="Ctrl+Alt+Q">
   </key>
   
   <key
      commandId="com.1cai.edt.commands.optimize"
      schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
      sequence="Ctrl+Alt+O">
   </key>
</extension>
   
   <!-- Preferences -->
   <extension point="org.eclipse.ui.preferencePages">
      <page
         id="com.1cai.edt.preferences.main"
         name="1C AI Assistant"
         class="com.1cai.edt.preferences.MainPreferencePage">
      </page>
      
      <page
         id="com.1cai.edt.preferences.connection"
         name="Connection Settings"
         category="com.1cai.edt.preferences.main"
         class="com.1cai.edt.preferences.ConnectionPreferencePage">
      </page>
   </extension>
   
   <!-- Startup extension (for initialization) -->
   <extension point="org.eclipse.ui.startup">
      <startup class="com.1cai.edt.Activator"/>
   </extension>
</plugin>
